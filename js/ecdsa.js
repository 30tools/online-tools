!function(){function e(e,t,r){return"pem_text"===e?r?KEYUTIL.getKey(t).pubKeyHex:KEYUTIL.getKey(t).prvKeyHex:"base64"===e?b64tohex(t):t}window.sign=function(t,r,a,i,n){if(i=e(a,i)){var o=new KJUR.crypto.Signature({alg:n});return o.init({d:i,curve:r}),"string"==typeof t?o.updateString(t):o.updateHex(ot.bytesToHex(t)),o.sign()}},window.verify=function(t,r,a,i,n,o,p){if((i=e(a,i,!0))&&(p=e(o,p))){var u=new KJUR.crypto.Signature({alg:n});return u.init({xy:i,curve:r}),"string"==typeof t?u.updateString(t):u.updateHex(ot.bytesToHex(t)),u.verify(p)?"Valid":"Invalid"}};var t=$("#public-key"),r=$("#download-image"),a=$("#download-public");r.attr("download","private.pem"),window.generate=function(e,i,n){var o,p;if("pem_text"===n){var u=KEYUTIL.generateKeypair("EC",i),d=u.prvKeyObj,c=u.pubKeyObj;p=KEYUTIL.getPEM(d,"PKCS8PRV"),o=KEYUTIL.getPEM(c,"PKCS8PUB"),r.attr("href","data:application/octet-stream;,"+p),a.attr("href","data:application/octet-stream;,"+o),r.show(),a.show()}else{r.hide(),a.hide();var y=new KJUR.crypto.ECDSA({curve:i}),g=y.generateKeyPairHex();o=g.ecpubhex,p=g.ecprvhex,"base64"===n&&(o=hextob64(o),p=hextob64(p))}return t.val(o),p}}();