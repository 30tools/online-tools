!function(){function e(e,t,a){return"pem_text"===e?a?KEYUTIL.getKey(t).pubKeyHex:KEYUTIL.getKey(t).prvKeyHex:"base64"===e?b64tohex(t):t}function t(){KJUR.asn1.x509.OID.name2oidList.secp192k1="1.3.132.0.31",KJUR.asn1.x509.OID.name2oidList.secp224r1="1.3.132.0.33",a=!0}window.sign=function(t,a,n,r,i){if(r=e(n,r)){var o=new KJUR.crypto.Signature({alg:i});return o.init({d:r,curve:a}),"string"==typeof t?o.updateString(t):o.updateHex(ot.bytesToHex(t)),o.sign()}},window.verify=function(t,a,n,r,i,o,p){if((r=e(n,r,!0))&&(p=e(o,p))){var u=new KJUR.crypto.Signature({alg:i});return u.init({xy:r,curve:a}),"string"==typeof t?u.updateString(t):u.updateHex(ot.bytesToHex(t)),u.verify(p)?"Valid":"Invalid"}};var a=!1,n=$("#public-key"),r=$("#download-image"),i=$("#download-public");r.attr("download","private.pem"),window.generate=function(e,a,o){t();var p,u;if("pem_text"===o){var c=KEYUTIL.generateKeypair("EC",a),d=c.prvKeyObj,K=c.pubKeyObj;u=KEYUTIL.getPEM(d,"PKCS8PRV"),p=KEYUTIL.getPEM(K,"PKCS8PUB"),r.attr("href","data:application/octet-stream;,"+u),i.attr("href","data:application/octet-stream;,"+p),r.show(),i.show()}else{r.hide(),i.hide();var s=new KJUR.crypto.ECDSA({curve:a}),y=s.generateKeyPairHex();p=y.ecpubhex,u=y.ecprvhex,"base64"===o&&(p=hextob64(p),u=hextob64(u))}return n.val(p),u}}();