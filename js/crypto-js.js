!function(){function r(r){for(var t=r.length,e=[],o=0;o<t;o++)e[o>>>2]|=r[o]<<24-o%4*8;return new CryptoJS.lib.WordArray.init(e,t)}function t(r){for(var t=r.words,e=r.sigBytes,o=[],n=0;n<e;n++)o.push(t[n>>>2]>>>24-n%4*8&255);return o}function e(t){return r("string"==typeof t?ot.utf8ToBytes(t):t)}function o(r,t,o,n,i,s,a,p,c,y,d){if("custom"===n){if(c=e(c),c.sigBytes!==r/8)throw new Error("Key must be "+r+" bits.");if("ECB"!==o&&(y=e(y),8*y.sigBytes!==t))throw new Error("IV must be "+t+" bits.")}else{var u,g;"PBKDF2"===n?(u=CryptoJS.PBKDF2,g=1e4):(u=CryptoJS.EvpKDF,g=1);var f=u(i,d||"",{keySize:r/32+t/32,iterations:a?p:g,hasher:CryptoJS.algo[s]}).toString();c=CryptoJS.enc.Hex.parse(f.substr(0,r/4)),y=CryptoJS.enc.Hex.parse(f.substr(r/4))}return[c,y]}function n(r,t,e,o){return!c[r]||"NoPadding"!==t||e%(o/8)==0}function i(r,i,s,a,p,y,d,u,g,f,l,S,C,w,h){if(!s)return[];if(!n(p,y,s.length,i))throw new Error("Message must be multipler of "+i+" bits.");if("random"===w)h=CryptoJS.lib.WordArray.random(8);else if("nosalt"===w)h=null;else if(h=e(h),8!==h.sigBytes)throw new Error("Salt must be 64 bits.");var J=c[p]?CryptoJS.pad[y]:CryptoJS.pad.NoPadding,v=o(a,i,p,d,u,g,f,l,S,C,h),b=r.encrypt(e(s),v[0],{iv:v[1],mode:CryptoJS.mode[p],padding:J}),B=b.ciphertext;return"custom"!==d&&h&&(B=CryptoJS.lib.WordArray.create([1398893684,1701076831]).concat(h).concat(B)),t(B)}function s(e,i,s,a,y,d,u,g,f,l,S,C,w){if(s.length){var h;if(s=r(s),"custom"===u)s=CryptoJS.lib.CipherParams.create({ciphertext:s});else{var J=s.words;1398893684==J[0]&&1701076831==J[1]&&(h=CryptoJS.lib.WordArray.create(J.slice(2,4)),J.splice(0,4),s.sigBytes-=16),s=CryptoJS.lib.CipherParams.create({ciphertext:s,salt:h})}var v=c[y]?CryptoJS.pad[d]:CryptoJS.pad.NoPadding,b=o(a,i,y,u,g,f,l,S,C,w,h),B=e.decrypt(s,b[0],{iv:b[1],mode:CryptoJS.mode[y],padding:v}),m=s.ciphertext.sigBytes,E=m-i/8;if(B.sigBytes<E||B.sigBytes>m||!n(y,d,B.sigBytes,i))throw new Error(p);return t(B)}}function a(r,t){var e=255&r.words[r.sigBytes-1>>>2],o=r.sigBytes;if(0===e||e>o)throw new Error(p);if("Iso10126"!==t)for(var n="Pkcs7"===t?e:0,i=o-2;i>o-e-1;--i){var s=r.words[i>>>2]>>>24-i%4*8&255;if(s!==n)throw new Error(p)}r.sigBytes-=e}var p="bad decrypt",c={CBC:!0,ECB:!0};window.aes={},window.des={},window.tripleDes={},aes.encrypt=function(r,t,e,o,n,s,a,p,c,y,d,u,g){return i(CryptoJS.AES,128,r,t,e,o,n,s,a,p,c,y,d,u,g)},des.encrypt=function(r,t,e,o,n,s,a,p,c,y,d,u){return i(CryptoJS.DES,64,r,64,t,e,o,n,s,a,p,c,y,d,u)},tripleDes.encrypt=function(r,t,e,o,n,s,a,p,c,y,d,u,g){return i(CryptoJS.TripleDES,64,r,t,e,o,n,s,a,p,c,y,d,u,g)},aes.decrypt=function(r,t,e,o,n,i,a,p,c,y,d){return s(CryptoJS.AES,128,r,t,e,o,n,i,a,p,c,y,d)},des.decrypt=function(r,t,e,o,n,i,a,p,c,y){return s(CryptoJS.DES,64,r,64,t,e,o,n,i,a,p,c,y)},tripleDes.decrypt=function(r,t,e,o,n,i,a,p,c,y,d){return s(CryptoJS.TripleDES,64,r,t,e,o,n,i,a,p,c,y,d)};var y=$("#mode"),d=$("#iv-block"),u=$("#padding-block");y.change(function(){var r=y.val();d.toggle("ECB"!==r),u.toggle(!!c[r])}),y.change();var g=$("#key-type"),f=$("#key-iv"),l=$("#derivation-block");g.change(function(){var r="custom"===g.val();f.toggle(r),l.toggle(!r)}),g.change();var S=$("#salt-type"),C=$("#salt-block");S.length&&(S.change(function(){C.toggle("custom"===S.val())}),S.change()),$(window).on("methodLoad",function(){CryptoJS.pad.Pkcs7.unpad=function(r){a(r,"Pkcs7")},CryptoJS.pad.Iso97971.unpad=function(r){CryptoJS.pad.ZeroPadding.unpad(r);var t=r.sigBytes-1;if(128!=(r.words[t>>>2]>>>24-t%4*8&255))throw new Error(p);r.sigBytes--},CryptoJS.pad.AnsiX923.unpad=function(r){a(r,"AnsiX923")},CryptoJS.pad.Iso10126.unpad=function(r){a(r,"Iso10126")}})}();