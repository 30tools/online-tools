!function(){function t(){this.result=[]}function r(t){for(var r=t.length,e=[],n=0;n<r;n++)e[n>>>2]|=t[n]<<24-n%4*8;return new z.init(e,r)}function e(t){for(var r=t.words,e=t.sigBytes,n=new g(e),o=0;o<e;o++)n[o]=r[o>>>2]>>>24-o%4*8&255;return n}function n(t){return"string"==typeof t?ot.utf8ToBytes(t):t}function o(t){return r(n(t))}function i(t,r,e,n,i,s,a,u,c,f,l){if("custom"===n){if(c=o(c),c.sigBytes!==t/8)throw new Error("Key must be "+t+" bits.");if("ECB"!==e&&(f=o(f),8*f.sigBytes!==r))throw new Error("IV must be "+r+" bits.")}else{var d,p;"PBKDF2"===n?(d=x.PBKDF2,p=1e4):(d=x.EvpKDF,p=1);var w=d(i,l||"",{keySize:t/32+r/32,iterations:a?u:p,hasher:_[s]}).toString();c=x.enc.Hex.parse(w.substr(0,t/4)),f=x.enc.Hex.parse(w.substr(t/4))}return[c,f]}function s(t,r,e,n,o,s,a,u,c,f,l,d,p){var g=w[e]?F[d]:F.NoPadding,y=i(t,r,e,n,o,s,a,u,c,f,l);return[y[0],{iv:y[1],mode:P[e],padding:g,drop:p}]}function a(t,r,e,n){return!w[t]||"NoPadding"!==r||e%(n/8)==0}function u(t,r,e){if("custom"===t&&(e=8*o(r).sigBytes)<40)throw new Error("Key should be greater or equal than 40 bits.");return e}function c(r,i,u,c,f,l,d,p,w,g,y,h,v,B,E,D,m){c=n(c);var b=c.length;if(ot.getFile&&(ot.setFilename(r),b=ot.getFile().size),!a(l,d,b,u))throw new Error("Message must be multipler of "+u+" bits.");if("random"===E)D=z.random(8);else if("nosalt"===E)D=null;else if(D=o(D),8!==D.sigBytes)throw new Error("Salt must be 64 bits.");var A=s(f,u,l,p,w,g,y,h,v,B,D,d,m),S=i.createEncryptor(A[0],A[1]),C=new(ot.DownloadBuilder||t);"custom"!==p&&D&&C.push(e(z.create([1398893684,1701076831]).concat(D)));var x={update:function(t){var r=o(t instanceof ArrayBuffer?new Uint8Array(t):t),n=S.process(r);return C.push(e(n)),x},hex:function(){var t=S.finalize();return C.push(e(t)),ot.setDownload?(ot.setDownload(C.finalize()),ot.DOWNLOAD_MESSAGE):C.result}};return x.update(c)}function f(t){var r=function(){return t.apply(this,Array.prototype.slice.call(arguments,0)).hex()};return r.update=t,r}function l(n,i,u,c,f,l,d,w,g,y,h,v,B,E){var D=u.length;ot.getFile&&(D=ot.getFile().size),u=u instanceof ArrayBuffer?new Uint8Array(u):u;var m;if("custom"!==d){u=r(u);var b=u.words;1398893684==b[0]&&1701076831==b[1]&&(m=z.create(b.slice(2,4)),b.splice(0,4),u.sigBytes-=16,D-=16),u=e(u)}if(!a(f,l,D,i))throw new Error("Message must be multipler of "+i+" bits.");var A=0,S=s(c,i,f,d,w,g,y,h,v,B,m,l,E),C=n.createDecryptor(S[0],S[1]),x=new(ot.DownloadBuilder||t),k={update:function(t){var r=o(t instanceof ArrayBuffer?new Uint8Array(t):t),n=C.process(r);return A+=n.sigBytes,x.push(e(n)),k},hex:function(){var t=C.finalize();A+=t.sigBytes;var r=D;if(A<r-i/8||A>r)throw new Error(p);return x.push(e(t)),ot.setDownload?(ot.setDownload(x.finalize()),ot.DOWNLOAD_MESSAGE):x.result}};return k.update(u)}function d(t,r){var e=255&t.words[t.sigBytes-1>>>2],n=t.sigBytes;if(0===e||e>n)throw new Error(p);if("Iso10126"!==r)for(var o="Pkcs7"===r?e:0,i=n-2;i>n-e-1;--i){var s=t.words[i>>>2]>>>24-i%4*8&255;if(s!==o)throw new Error(p)}t.sigBytes-=e}var p="bad decrypt",w={CBC:!0,ECB:!0},g=window.Uint8Array||Array;window.aes={},window.des={},window.tripleDes={},window.rc4={},t.prototype.push=function(t){this.result=this.result.concat(Array.from(t))},aes.encrypt=f(function(t,r,e,n,o,i,s,a,u,f,l,d,p){return c("aes.txt",_.AES,128,t,r,e,n,o,i,s,a,u,f,l,d,p)}),des.encrypt=f(function(t,r,e,n,o,i,s,a,u,f,l,d){return c("des.txt",_.DES,64,t,64,r,e,n,o,i,s,a,u,f,l,d)}),tripleDes.encrypt=f(function(t,r,e,n,o,i,s,a,u,f,l,d,p){return c("3des.txt",_.TripleDES,64,t,r,e,n,o,i,s,a,u,f,l,d,p)}),rc4.encrypt=f(function(t,r,e,n,o,i,s,a,f,l,d){return f=u(e,a,f),c("rc4.txt",_.RC4Drop,0,t,f,"ECB",null,e,n,o,i,s,a,null,l,d,r)}),aes.decrypt=f(function(t,r,e,n,o,i,s,a,u,c,f){return l(_.AES,128,t,r,e,n,o,i,s,a,u,c,f)}),des.decrypt=f(function(t,r,e,n,o,i,s,a,u,c){return l(_.DES,64,t,64,r,e,n,o,i,s,a,u,c)}),tripleDes.decrypt=f(function(t,r,e,n,o,i,s,a,u,c,f){return l(_.TripleDES,64,t,r,e,n,o,i,s,a,u,c,f)}),rc4.decrypt=f(function(t,r,e,n,o,i,s,a,c){return c=u(e,a,c),l(_.RC4Drop,0,t,c,"ECB",null,e,n,o,i,s,a,null,r)});var y=$("#mode"),h=$("#iv-block"),v=$("#padding-block"),B=function(){var t=y.val();h.toggle("ECB"!==t),v.toggle(!!w[t])};y.change(B),B();var E=$("#key-type"),D=$("#key-iv"),m=$("#derivation-block"),b=function(){var t="custom"===E.val();D.toggle(t),m.toggle(!t)};E.change(b),b();var A=$("#salt-type"),S=$("#salt-block");if(A.length){var C=function(){S.toggle("custom"===A.val())};A.change(C),C()}var x,k,_,F,P,z;$(window).on("methodLoad",function(){x=CryptoJS,k=x.lib,_=x.algo,F=x.pad,P=x.mode,z=k.WordArray,F.Pkcs7.unpad=function(t){d(t,"Pkcs7")},F.Iso97971.unpad=function(t){F.ZeroPadding.unpad(t);var r=t.sigBytes-1;if(128!=(t.words[r>>>2]>>>24-r%4*8&255))throw new Error(p);t.sigBytes--},F.AnsiX923.unpad=function(t){d(t,"AnsiX923")},F.Iso10126.unpad=function(t){d(t,"Iso10126")},function(){function t(t){for(var r=this._S,e=this._i,n=this._j,o=0,i=0;i<t;i++){e=(e+1)%256,n=(n+r[e])%256;var s=r[e];r[e]=r[n],r[n]=s,o|=r[(r[e]+r[n])%256]<<24-i%4*8}return this._i=e,this._j=n,o}var r=_.RC4,e=_.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this),t.call(this,this.cfg.drop)}});x.RC4Drop=k.StreamCipher._createHelper(e)}()})}();