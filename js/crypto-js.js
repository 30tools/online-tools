!function(){function r(){this.result=[]}function t(r){for(var t=r.length,e=[],n=0;n<t;n++)e[n>>>2]|=r[n]<<24-n%4*8;return new z.init(e,t)}function e(r){for(var t=r.words,e=r.sigBytes,n=new g(e),o=0;o<e;o++)n[o]=t[o>>>2]>>>24-o%4*8&255;return n}function n(r){return"string"==typeof r?ot.utf8ToBytes(r):r}function o(r){return t(n(r))}function i(r,t,e,n,i,s,a,u,c,f,l){if("custom"===n){if(c=o(c),c.sigBytes!==r/8)throw new Error("Key must be "+r+" bits.");if("ECB"!==e&&(f=o(f),8*f.sigBytes!==t))throw new Error("IV must be "+t+" bits.")}else{var d,p;"PBKDF2"===n?(d=k.PBKDF2,p=1e4):(d=k.EvpKDF,p=1);var w=d(i,l||"",{keySize:r/32+t/32,iterations:a?u:p,hasher:F[s]}).toString();c=k.enc.Hex.parse(w.substr(0,r/4)),f=k.enc.Hex.parse(w.substr(r/4))}return[c,f]}function s(r,t,e,n,o,s,a,u,c,f,l,d,p){var g=w[e]?P[d]:P.NoPadding,y=i(r,t,e,n,o,s,a,u,c,f,l);return[y[0],{iv:y[1],mode:x[e],padding:g,drop:p}]}function a(r,t,e,n){return!w[r]||"NoPadding"!==t||e%(n/8)==0}function u(r,t,e){if("custom"===r&&(e=8*o(t).sigBytes)<40)throw new Error("Key should be greater or equal than 40 bits.");return e}function c(t,i,u,c,f,l,d,p,w,g,y,h,v,B,E,D,m){c=n(c);var b=c.length;if(ot.getFile&&(ot.setFilename(t),b=ot.getFile().size),!a(l,d,b,u))throw new Error("Message must be multipler of "+u+" bits.");if("random"===E)D=z.random(8);else if("nosalt"===E)D=null;else if(D=o(D),8!==D.sigBytes)throw new Error("Salt must be 64 bits.");var A=s(f,u,l,p,w,g,y,h,v,B,D,d,m),S=i.createEncryptor(A[0],A[1]),C=new(ot.DownloadBuilder||r);"custom"!==p&&D&&C.push(e(z.create([1398893684,1701076831]).concat(D)));var k={update:function(r){var t=o(r instanceof ArrayBuffer?new Uint8Array(r):r),n=S.process(t);return C.push(e(n)),k},hex:function(){var r=S.finalize();return C.push(e(r)),ot.setDownload?(ot.setDownload(C.finalize()),ot.DOWNLOAD_MESSAGE):C.result}};return k.update(c)}function f(r){var t=function(){return r.apply(this,Array.prototype.slice.call(arguments,0)).hex()};return t.update=r,t}function l(n,i,u,c,f,l,d,w,g,y,h,v,B,E){var D=u.length;ot.getFile&&(D=ot.getFile().size),u=u instanceof ArrayBuffer?new Uint8Array(u):u;var m;if("custom"!==d){u=t(u);var b=u.words;1398893684==b[0]&&1701076831==b[1]&&(m=z.create(b.slice(2,4)),b.splice(0,4),u.sigBytes-=16,D-=16),u=e(u)}if(!a(f,l,D,i))throw new Error("Message must be multipler of "+i+" bits.");var A=0,S=s(c,i,f,d,w,g,y,h,v,B,m,l,E),C=n.createDecryptor(S[0],S[1]),k=new(ot.DownloadBuilder||r),_={update:function(r){var t=o(r instanceof ArrayBuffer?new Uint8Array(r):r),n=C.process(t);return A+=n.sigBytes,k.push(e(n)),_},hex:function(){var r=C.finalize();A+=r.sigBytes;var t=D;if(A<t-i/8||A>t)throw new Error(p);return k.push(e(r)),ot.setDownload?(ot.setDownload(k.finalize()),ot.DOWNLOAD_MESSAGE):k.result}};return _.update(u)}function d(r,t){var e=255&r.words[r.sigBytes-1>>>2],n=r.sigBytes;if(0===e||e>n)throw new Error(p);if("Iso10126"!==t)for(var o="Pkcs7"===t?e:0,i=n-2;i>n-e-1;--i){var s=r.words[i>>>2]>>>24-i%4*8&255;if(s!==o)throw new Error(p)}r.sigBytes-=e}var p="bad decrypt",w={CBC:!0,ECB:!0},g=window.Uint8Array||Array;window.aes={},window.des={},window.tripleDes={},window.rc4={},r.prototype.push=function(r){this.result=this.result.concat(Array.from(r))},aes.encrypt=f(function(r,t,e,n,o,i,s,a,u,f,l,d,p){return c("aes.dat",F.AES,128,r,t,e,n,o,i,s,a,u,f,l,d,p)}),des.encrypt=f(function(r,t,e,n,o,i,s,a,u,f,l,d){return c("des.dat",F.DES,64,r,64,t,e,n,o,i,s,a,u,f,l,d)}),tripleDes.encrypt=f(function(r,t,e,n,o,i,s,a,u,f,l,d,p){return c("3des.dat",F.TripleDES,64,r,t,e,n,o,i,s,a,u,f,l,d,p)}),rc4.encrypt=f(function(r,t,e,n,o,i,s,a,f,l,d){return f=u(e,a,f),c("rc4.dat",F.RC4Drop,0,r,f,"ECB",null,e,n,o,i,s,a,null,l,d,t)}),aes.decrypt=f(function(r,t,e,n,o,i,s,a,u,c,f){return l(F.AES,128,r,t,e,n,o,i,s,a,u,c,f)}),des.decrypt=f(function(r,t,e,n,o,i,s,a,u,c){return l(F.DES,64,r,64,t,e,n,o,i,s,a,u,c)}),tripleDes.decrypt=f(function(r,t,e,n,o,i,s,a,u,c,f){return l(F.TripleDES,64,r,t,e,n,o,i,s,a,u,c,f)}),rc4.decrypt=f(function(r,t,e,n,o,i,s,a,c){return c=u(e,a,c),l(F.RC4Drop,0,r,c,"ECB",null,e,n,o,i,s,a,null,t)});var y=$("#mode"),h=$("#iv-block"),v=$("#padding-block"),B=function(){var r=y.val();h.toggle("ECB"!==r),v.toggle(!!w[r])};y.change(B),B();var E=$("#key-type"),D=$("#key-iv"),m=$("#derivation-block"),b=function(){var r="custom"===E.val();D.toggle(r),m.toggle(!r)};E.change(b),b();var A=$("#salt-type"),S=$("#salt-block");if(A.length){var C=function(){S.toggle("custom"===A.val())};A.change(C),C()}var k,_,F,P,x,z;$(window).on("methodLoad",function(){k=CryptoJS,_=k.lib,F=k.algo,P=k.pad,x=k.mode,z=_.WordArray,P.Pkcs7.unpad=function(r){d(r,"Pkcs7")},P.Iso97971.unpad=function(r){P.ZeroPadding.unpad(r);var t=r.sigBytes-1;if(128!=(r.words[t>>>2]>>>24-t%4*8&255))throw new Error(p);r.sigBytes--},P.AnsiX923.unpad=function(r){d(r,"AnsiX923")},P.Iso10126.unpad=function(r){d(r,"Iso10126")},function(){function r(r){for(var t=this._S,e=this._i,n=this._j,o=0,i=0;i<r;i++){e=(e+1)%256,n=(n+t[e])%256;var s=t[e];t[e]=t[n],t[n]=s,o|=t[(t[e]+t[n])%256]<<24-i%4*8}return this._i=e,this._j=n,o}var t=F.RC4,e=F.RC4Drop=t.extend({cfg:t.cfg.extend({drop:192}),_doReset:function(){t._doReset.call(this),r.call(this,this.cfg.drop)}});k.RC4Drop=_.StreamCipher._createHelper(e)}()})}();